<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Wealth Command</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Google Sign-In Meta -->
  <meta name="google-signin-client_id" content="86191691449-lop8lu293h8956071sr0jllc2qsdpc2e.apps.googleusercontent.com">
  <!-- Bootstrap 5 CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Animate.css -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <!-- Flatpickr -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <!-- Choices.js -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css">
  <link rel="stylesheet" href="styles.css">
  <link rel="manifest" href="manifest.json">
  <!-- Google Identity Services -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
  <!-- Loading Spinner -->
  <div id="globalLoading" class="global-loading d-none">
    <div class="loading-spinner">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-2">Loading Wealth Command...</p>
    </div>
  </div>

  <!-- Auth Screen -->
  <div id="authScreen" class="container-fluid d-flex align-items-center justify-content-center min-vh-100">
    <div class="row w-100">
      <div class="col-12 col-md-6 col-lg-4 mx-auto">
        <div class="card shadow animate__animated animate__fadeIn">
          <div class="card-body text-center p-5">
            <i class="bi bi-graph-up-arrow display-1 text-primary mb-4"></i>
            <h1 class="h3 mb-3">Wealth Command</h1>
            <p class="text-muted mb-4">Take control of your finances with intelligent tracking and insights</p>
            <div id="g_id_onload"
                 data-client_id="86191691449-lop8lu293h8956071sr0jllc2qsdpc2e.apps.googleusercontent.com"
                 data-context="signin"
                 data-ux_mode="popup"
                 data-callback="handleGoogleSignIn"
                 data-auto_prompt="false">
            </div>
            <div class="g_id_signin"
                 data-type="standard"
                 data-shape="rectangular"
                 data-theme="outline"
                 data-text="signin_with"
                 data-size="large"
                 data-logo_alignment="left">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main App -->
  <div id="app" class="d-none">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">
          <i class="bi bi-graph-up-arrow me-2"></i>
          Wealth Command
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a class="nav-link active" href="#" data-tab="dashboard">
                <i class="bi bi-speedometer2 me-1"></i>Dashboard
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" data-tab="transactions">
                <i class="bi bi-arrow-left-right me-1"></i>Transactions
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" data-tab="budgets">
                <i class="bi bi-wallet2 me-1"></i>Budgets
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" data-tab="reports">
                <i class="bi bi-bar-chart me-1"></i>Reports
              </a>
            </li>
          </ul>
          <div class="navbar-nav">
            <div class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                <i class="bi bi-person-circle me-1"></i>
                <span id="userName">User</span>
              </a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="#" id="darkModeToggle">
                  <i class="bi bi-moon me-2"></i>
                  <span>Dark Mode: <span id="darkModeStatus">Off</span></span>
                </a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item text-danger" href="#" id="signOutBtn">
                  <i class="bi bi-box-arrow-right me-2"></i>Sign Out
                </a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="container-fluid mt-4">
      <!-- Dashboard Tab -->
      <div id="dashboardTab" class="tab-content">
        <div class="row">
          <!-- Quick Stats -->
          <div class="col-12 mb-4">
            <div class="row g-3">
              <div class="col-6 col-md-3">
                <div class="card stat-card animate__animated">
                  <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start">
                      <div>
                        <h6 class="card-subtitle mb-2 text-muted">Balance</h6>
                        <h3 class="card-title mb-0" id="totalBalance">$0.00</h3>
                      </div>
                      <i class="bi bi-wallet2 text-primary fs-4"></i>
                    </div>
                    <div class="mt-2">
                      <small class="text-success" id="balanceTrend">
                        <i class="bi bi-arrow-up-right"></i> 0%
                      </small>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-6 col-md-3">
                <div class="card stat-card animate__animated">
                  <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start">
                      <div>
                        <h6 class="card-subtitle mb-2 text-muted">Income</h6>
                        <h3 class="card-title mb-0 text-success" id="totalIncome">$0.00</h3>
                      </div>
                      <i class="bi bi-arrow-down-left text-success fs-4"></i>
                    </div>
                    <div class="mt-2">
                      <small class="text-muted">This Month</small>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-6 col-md-3">
                <div class="card stat-card animate__animated">
                  <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start">
                      <div>
                        <h6 class="card-subtitle mb-2 text-muted">Expenses</h6>
                        <h3 class="card-title mb-0 text-danger" id="totalExpenses">$0.00</h3>
                      </div>
                      <i class="bi bi-arrow-up-right text-danger fs-4"></i>
                    </div>
                    <div class="mt-2">
                      <small class="text-muted">This Month</small>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-6 col-md-3">
                <div class="card stat-card animate__animated">
                  <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start">
                      <div>
                        <h6 class="card-subtitle mb-2 text-muted">Savings Rate</h6>
                        <h3 class="card-title mb-0" id="savingsRate">0%</h3>
                      </div>
                      <i class="bi bi-piggy-bank text-warning fs-4"></i>
                    </div>
                    <div class="mt-2">
                      <small class="text-muted">Monthly Goal</small>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Charts Row -->
          <div class="col-12 col-lg-8 mb-4">
            <div class="card h-100">
              <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">Spending Overview</h5>
                <div class="dropdown">
                  <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                    Last 30 Days
                  </button>
                  <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="#">Last 7 Days</a></li>
                    <li><a class="dropdown-item" href="#">Last 30 Days</a></li>
                    <li><a class="dropdown-item" href="#">Last 90 Days</a></li>
                  </ul>
                </div>
              </div>
              <div class="card-body position-relative">
                <div id="chartLoading" class="chart-loading">
                  <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading chart...</span>
                  </div>
                </div>
                <canvas id="spendingChart" height="300"></canvas>
              </div>
            </div>
          </div>

          <!-- Recent Transactions -->
          <div class="col-12 col-lg-4 mb-4">
            <div class="card h-100">
              <div class="card-header">
                <h5 class="card-title mb-0">Recent Transactions</h5>
              </div>
              <div class="card-body p-0">
                <div id="recentTransactionsList" class="list-group list-group-flush">
                  <!-- Recent transactions will be populated here -->
                </div>
                <div id="recentTransactionsEmpty" class="text-center py-5 d-none">
                  <i class="bi bi-receipt display-4 text-muted mb-3"></i>
                  <h6>No Transactions Yet</h6>
                  <p class="text-muted small mb-3">Start by adding your first transaction</p>
                  <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#addTransactionModal">
                    Add Transaction
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Category Breakdown -->
          <div class="col-12 col-lg-6 mb-4">
            <div class="card h-100">
              <div class="card-header">
                <h5 class="card-title mb-0">Spending by Category</h5>
              </div>
              <div class="card-body position-relative">
                <div id="categoryChartLoading" class="chart-loading">
                  <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading categories...</span>
                  </div>
                </div>
                <canvas id="categoryChart" height="250"></canvas>
              </div>
            </div>
          </div>

          <!-- Budget Progress -->
          <div class="col-12 col-lg-6 mb-4">
            <div class="card h-100">
              <div class="card-header">
                <h5 class="card-title mb-0">Budget Progress</h5>
              </div>
              <div class="card-body">
                <div id="budgetProgressList">
                  <!-- Budget progress bars will be populated here -->
                </div>
                <div id="budgetProgressEmpty" class="text-center py-5 d-none">
                  <i class="bi bi-wallet2 display-4 text-muted mb-3"></i>
                  <h6>No Budgets Set</h6>
                  <p class="text-muted small mb-3">Create budgets to track your spending goals</p>
                  <button class="btn btn-primary btn-sm" data-tab="budgets">
                    Set Up Budgets
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Transactions Tab -->
      <div id="transactionsTab" class="tab-content d-none">
        <div class="row">
          <div class="col-12">
            <div class="card">
              <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">All Transactions</h5>
                <div class="d-flex gap-2">
                  <div class="input-group input-group-sm" style="width: 250px;">
                    <input type="text" id="transactionSearch" class="form-control" placeholder="Search transactions...">
                    <span class="input-group-text"><i class="bi bi-search"></i></span>
                  </div>
                  <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#addTransactionModal">
                    <i class="bi bi-plus-lg me-1"></i>Add Transaction
                  </button>
                </div>
              </div>
              <div class="card-body p-0">
                <div class="table-responsive">
                  <table class="table table-hover mb-0">
                    <thead class="table-light">
                      <tr>
                        <th>Date</th>
                        <th>Description</th>
                        <th>Category</th>
                        <th>Amount</th>
                        <th>Type</th>
                        <th>Actions</th>
                      </tr>
                    </thead>
                    <tbody id="transactionsTableBody">
                      <!-- Transactions will be populated here -->
                    </tbody>
                  </table>
                </div>
                <div id="transactionsEmpty" class="text-center py-5 d-none">
                  <i class="bi bi-credit-card display-4 text-muted mb-3"></i>
                  <h5>No Transactions Yet</h5>
                  <p class="text-muted mb-4">Start tracking your finances by adding your first transaction</p>
                  <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addTransactionModal">
                    <i class="bi bi-plus-lg me-1"></i>Add Your First Transaction
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Budgets Tab -->
      <div id="budgetsTab" class="tab-content d-none">
        <div class="row">
          <div class="col-12">
            <div class="card">
              <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">Budget Management</h5>
                <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#addBudgetModal">
                  <i class="bi bi-plus-lg me-1"></i>Add Budget
                </button>
              </div>
              <div class="card-body">
                <div class="row" id="budgetsGrid">
                  <!-- Budget cards will be populated here -->
                </div>
                <div id="budgetsEmpty" class="text-center py-5 d-none">
                  <i class="bi bi-wallet2 display-4 text-muted mb-3"></i>
                  <h5>No Budgets Created</h5>
                  <p class="text-muted mb-3">Create budgets to help manage your spending and reach your financial goals</p>
                  <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addBudgetModal">
                    <i class="bi bi-plus-lg me-1"></i>Create Your First Budget
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Reports Tab -->
      <div id="reportsTab" class="tab-content d-none">
        <div class="row">
          <div class="col-12 mb-4">
            <div class="card">
              <div class="card-header">
                <h5 class="card-title mb-0">Financial Reports</h5>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col-md-4 mb-3">
                    <div class="card bg-light">
                      <div class="card-body text-center">
                        <i class="bi bi-bar-chart display-4 text-primary mb-3"></i>
                        <h5>Income vs Expenses</h5>
                        <p class="text-muted">Compare your income and expenses over time</p>
                        <button class="btn btn-outline-primary" onclick="generateIncomeExpenseReport()">
                          Generate Report
                        </button>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 mb-3">
                    <div class="card bg-light">
                      <div class="card-body text-center">
                        <i class="bi bi-pie-chart display-4 text-success mb-3"></i>
                        <h5>Category Analysis</h5>
                        <p class="text-muted">Detailed breakdown of spending by category</p>
                        <button class="btn btn-outline-primary" onclick="generateCategoryReport()">
                          Generate Report
                        </button>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 mb-3">
                    <div class="card bg-light">
                      <div class="card-body text-center">
                        <i class="bi bi-graph-up display-4 text-warning mb-3"></i>
                        <h5>Trend Analysis</h5>
                        <p class="text-muted">Track your financial trends and patterns</p>
                        <button class="btn btn-outline-primary" onclick="generateTrendReport()">
                          Generate Report
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Report Output -->
          <div class="col-12">
            <div class="card">
              <div class="card-header">
                <h5 class="card-title mb-0" id="reportTitle">Report Output</h5>
              </div>
              <div class="card-body position-relative">
                <div id="reportLoading" class="chart-loading d-none">
                  <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Generating report...</span>
                  </div>
                </div>
                <div id="reportOutput">
                  <div id="reportsEmpty" class="text-center py-5">
                    <i class="bi bi-bar-chart display-4 text-muted mb-3"></i>
                    <h5>No Report Generated</h5>
                    <p class="text-muted">Select a report type above to generate detailed financial insights</p>
                    <div class="text-muted small">
                      <i class="bi bi-lightbulb me-1"></i>
                      Tip: Use reports to identify spending patterns and optimize your budget
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Quick Add FAB -->
    <button id="quickAddFab" class="btn btn-primary btn-floating animate__animated" data-bs-toggle="modal" data-bs-target="#addTransactionModal">
      <i class="bi bi-plus-lg"></i>
    </button>

    <!-- Add Transaction Modal -->
    <div class="modal fade" id="addTransactionModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add Transaction</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form id="addTransactionForm">
              <div class="mb-3">
                <label class="form-label">Description</label>
                <input type="text" class="form-control" name="description" required>
                <div class="form-text">Enter a clear description for this transaction</div>
              </div>
              <div class="mb-3">
                <label class="form-label">Amount</label>
                <div class="input-group">
                  <span class="input-group-text">$</span>
                  <input type="number" class="form-control" name="amount" step="0.01" required>
                </div>
                <div class="invalid-feedback">Please enter a valid amount</div>
              </div>
              <div class="mb-3">
                <label class="form-label">Type</label>
                <select class="form-select" name="type" required>
                  <option value="">Select Type</option>
                  <option value="income">Income</option>
                  <option value="expense">Expense</option>
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Category</label>
                <select class="form-select" name="category" id="transactionCategory" required>
                  <option value="">Select Category</option>
                  <!-- Categories will be populated dynamically -->
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Date</label>
                <input type="text" class="form-control flatpickr" name="date" id="transactionDate" required>
              </div>
              <div class="mb-3">
                <label class="form-label">Recent Categories</label>
                <div id="recentCategories" class="d-flex flex-wrap gap-2">
                  <!-- Recent categories will be populated here -->
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" onclick="addTransaction()">Add Transaction</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Budget Modal -->
    <div class="modal fade" id="addBudgetModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Create Budget</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form id="addBudgetForm">
              <div class="mb-3">
                <label class="form-label">Category</label>
                <select class="form-select" name="category" required>
                  <option value="">Select Category</option>
                  <!-- Categories will be populated dynamically -->
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Budget Amount</label>
                <div class="input-group">
                  <span class="input-group-text">$</span>
                  <input type="number" class="form-control" name="amount" step="0.01" required>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label">Time Period</label>
                <select class="form-select" name="period" required>
                  <option value="monthly">Monthly</option>
                  <option value="weekly">Weekly</option>
                </select>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" onclick="addBudget()">Create Budget</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Success/Error Toast Container -->
    <div id="toastContainer" class="toast-container position-fixed top-0 end-0 p-3"></div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/date-fns@2.29.3/index.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/numeral@2.0.6/numeral.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
  <script src="app.js"></script>
</body>
</html>
